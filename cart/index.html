<!DOCTYPE html>
<html lang="en" data-bs-theme="dark" class="bg-black">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Cart - AstroTours</title>
		<script type="module" defer src="/js/index.mjs"></script>
		<link rel="shortcut icon" href="/assets/logo.png" type="image/x-icon" />
		<link rel="stylesheet" href="/css/main.css" />
		<link
			rel="stylesheet"
			type="text/css"
			href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css"
		/>
		<link rel="stylesheet" href="/css/main.css" />
	</head>
	<body class="bg-black min-h-[calc(100vh-4rem)]">
		<div id="stars"></div>
		<div id="loader"></div>
		<wm-navbar></wm-navbar>
		<div
			id="main"
			class="flex flex-col my-8 mx-8 md:mx-16 lg:mx-32 items-center"
			un-cloak
		>
			<h1 class="font-bold mb-8">Cart</h1>

			<template v-if="items.length">
				<div
					class="flex flex-col lg:justify-center max-w-full !lg:w-[75%] !lg-px-48 lg:items-start items-center md:w-xl lg:grid lg:grid-cols-[2fr_1fr] gap-4"
				>
					<div class="flex justify-center items-center max-w-full">
						<div class="card bg-gray-800 rounded-md w-md lg:w-full">
							<div class="card-body">
								<template v-for="item in items">
									<h5 class="card-title">{{ item[0].name }}</h5>
									<div class="flex flex-row place-content-between">
										<div class="flex flex-row items-center">
											Qty:
											<select
												@change="changeQuantity(item[0].name, $el.value)"
												class="ml-2 form-select form-select-sm"
											>
												<option
													v-for="i in item[0].maxPeople"
													:selected="i === item[1]"
													:value="i"
												>
													{{ i }}
												</option>
											</select>
										</div>
										<p>${{ item[0].price }}</p>
									</div>
									<div class="w-full flex justify-between">
										<div class="flex flex-col md:flex-row gap-1">
											<input type="date" class="form-control !w-36" />
											<input type="date" class="form-control !w-36" />
										</div>
										<button
											type="button"
											class="btn btn-danger btn-small self-end"
											@click="removeItem(item[0].name)"
											@vue:mounted="addBlobListeners($el)"
										>
											Remove
										</button>
									</div>
									<div
										class="h-[1px] bg-[var(--bs-border-color-translucent)] w-full my-2 last:hidden"
									></div>
								</template>
							</div>
						</div>
					</div>
					<div class="max-w-full">
						<div class="card bg-gray-800 rounded-md">
							<div class="card-body">
								<h5 class="card-title">Order Summary</h5>
								<div class="w-full">
									<div class="flex flex-row justify-between">
										<p>Subtotal</p>
										<p>
											{{ numberFormatter.format(items.reduce((acc, val) => acc +
											val[0].price * val[1], 0)) }}
										</p>
									</div>
									<div class="flex flex-row justify-between">
										<p>Estimated Tax</p>
										<p>
											{{ numberFormatter.format(items.reduce((acc, val) => acc +
											val[0].price * val[1], 0) * 0.1) }}
										</p>
									</div>
									<div class="flex flex-row justify-between font-bold">
										<p>Estimated Total</p>
										<p>
											{{ numberFormatter.format(items.reduce((acc, val) => acc +
											val[0].price * val[1], 0) * 1.1) }}
										</p>
									</div>
									<div class="mb-3">
										<label class="form-label">Insurance Policy Number</label>
										<input
											v-model="policyNumber"
											required
											type="text"
											class="form-control"
										/>
									</div>
									<div class="mb-3">
										<label class="form-label">Name of Insured</label>
										<input
											v-model="name"
											required
											type="text"
											class="form-control"
										/>
									</div>
									<div class="form-check">
										<input
											class="form-check-input"
											type="checkbox"
											v-model="agree"
											id="flexCheckDefault"
										/>
										<label class="form-check-label" for="flexCheckDefault">
											By checking this box, I understand that AstroTours is not
											liable for any potential hazards during space flights
											including sun radiation, hostile space environment and
											altered gravity fields.
										</label>
									</div>
								</div>
								<div class="flex justify-end">
									<button
										@click="checkout"
										@vue:mounted="addBlobListeners($el)"
										class="btn btn-primary animate-wobble"
									>
										Purchase
									</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</template>
			<template v-else>
				<p>
					No items! Go to our
					<a href="/book" @vue:mounted="routerLink($el)">book</a> page to book a
					trip!
				</p>
			</template>
		</div>
		<wm-footer></wm-footer>
	</body>
</html>
